<html>
<head>
  <title>Rooftop Snipers | 3kh0</title>
  
 <link rel="icon" sizes="192x192" href="img/thumb.png">
 <link rel="shortcut icon" href="img/thumb.png" type="image/x-icon"/>
 <link rel="apple-touch-icon" href="img/thumb.png" type="image/x-icon"/>
  
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <meta content="https://3kh0.github.io/rooftop-snipers" property="og:url" />
   <meta content="https://3kh0.github.io/rooftop-snipers/img/thumb.png" property="og:image" />
   <meta content="#000000" data-react-helmet="true" name="theme-color" />
   <meta name="title" content="Rooftop Snipers">
   <meta name="description" content="Rooftop Snipers is a pixel-style shooting game where you have to shoot famous characters off of the roof. You can play in single or two-player mode, against the Joker, Mr. T, and John Wayne. During each duel, you have to jump forwards and backwards to dodge bullets. Look out for the tomahawks and beach balls in Rooftop Snipers.">
   <meta name="keywords" content="games, ad blocker, trolls, unblocked games, web games, online games, fun, tags">
   <meta name="robots" content="index, follow">
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <meta name="language" content="English">
   <meta name="revisit-after" content="1 days">
   <meta name="author" content="3kh0">
  
    <link rel="stylesheet" href="TemplateData/style.css">
    <script src="TemplateData/UnityProgress.js"></script>
    <script src="TemplateData/UnityLoader.js"></script>
    <script>
        var gameInstance = UnityLoader.instantiate("gameContainer", "Build/rooftop-snipers.json", { onProgress: UnityProgress, Module: { onRuntimeInitialized: function() { UnityProgress(gameInstance, "complete") } } });
    </script>
</head>
<body style="margin: 0; overflow: hidden;">
    <div class="webgl-content">
        <div id="gameContainer" style="width: 100%; height: 100%; margin: 0;"></div>
    </div>







<script>
(function () {

  const PARENT_ORIGIN_MATCH = "macbooksuck.xyz";

  function allowedParent(origin) {
    return origin && origin.includes(PARENT_ORIGIN_MATCH);
  }

  function sendToParent(message) {
    parent.postMessage(message, "*");
  }

  async function exportSave() {

    if (typeof FS !== "undefined") {
      try {
        const filePath = "/idbfs/PlayerPrefs";
        const stat = FS.stat(filePath);
        const stream = FS.open(filePath, "r");
        const buffer = new Uint8Array(stat.size);

        FS.read(stream, buffer, 0, stat.size, 0);
        FS.close(stream);

        const base64 = btoa(
          String.fromCharCode.apply(null, Array.from(buffer))
        );

        sendToParent({
          type: "EXPORT_SAVE",
          gameId: location.pathname,
          payload: {
            type: "unity",
            unity_save_file_v1: base64
          }
        });

        console.log("[Game] Unity/Godot save exported");
        return;
      } catch (e) {
        console.warn("[Game] Unity export failed:", e);
      }
    }

    try {
      const data = {};
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        data[key] = localStorage.getItem(key);
      }

      sendToParent({
        type: "EXPORT_SAVE",
        gameId: location.pathname,
        payload: {
          type: "html5",
          storage: data
        }
      });

      console.log("[Game] HTML5 localStorage exported");
      return;

    } catch (e) {
      console.error("[Game] HTML5 export failed:", e);
    }

    sendToParent({
      type: "EXPORT_SAVE",
      gameId: location.pathname,
      payload: { type: "none" }
    });
  }

  async function importSave(payload) {

    if (!payload) return;

    if (payload.type === "unity" && payload.unity_save_file_v1 && typeof FS !== "undefined") {
      try {
        const binary = atob(payload.unity_save_file_v1);
        const bytes = new Uint8Array(binary.length);

        for (let i = 0; i < binary.length; i++) {
          bytes[i] = binary.charCodeAt(i);
        }

        const filePath = "/idbfs/PlayerPrefs";
        const stream = FS.open(filePath, "w+");

        FS.write(stream, bytes, 0, bytes.length, 0);
        FS.close(stream);

        FS.syncfs(false, function () {
          console.log("[Game] Unity/Godot save restored");
          alert("Cloud save restored. Reload the game.");
        });

        return;
      } catch (e) {
        console.error("[Game] Unity import failed:", e);
      }
    }

    if (payload.type === "html5" && payload.storage) {
      try {
        Object.entries(payload.storage).forEach(([k, v]) => {
          localStorage.setItem(k, v);
        });

        console.log("[Game] HTML5 save restored");
        alert("Cloud save restored. Reload the game.");
        return;

      } catch (e) {
        console.error("[Game] HTML5 import failed:", e);
      }
    }
  }

  window.addEventListener("message", function (event) {

    if (!allowedParent(event.origin)) return;

    const data = event.data || {};

    if (data.type === "REQUEST_EXPORT_SAVE") {
      exportSave();
    }

    if (data.type === "IMPORT_SAVE") {
      importSave(data.payload);
    }

  });

  console.log("[Game] Cloud save responder installed");

})();
</script>
</body>
</html>
